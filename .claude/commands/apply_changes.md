# Apply Frontend Changes

This command applies exported FastAPI backend changes to frontend applications based on the 3 export files generated by `/export_changes`.

## Purpose

Systematically update frontend code to match backend API changes using the minimal export files as a guide.

## Prerequisites

Run `/export_changes` first to generate:
- `api_changes.md` - API endpoint and response changes
- `types_to_update.md` - TypeScript interface updates
- `checklist.md` - Korean progress checklist

## What This Command Does

1. **Updates API Calls**: Applies endpoint URL changes from `api_changes.md`
2. **Updates TypeScript Types**: Implements interface changes from `types_to_update.md`  
3. **Updates Field References**: Renames fields throughout components and services
4. **Maintains Code Style**: Preserves existing patterns and conventions

## Implementation Process

### Step 1: Apply API Changes
From `api_changes.md`:

#### Update Service Layer
```typescript
// Find old endpoints
await api.post('/api/v0/survey/examination', data)

// Replace with new endpoints
await api.post('/api/v0/survey/examination/cycle/1', data)
```

#### Update Field Names in Responses
```typescript
// Find old field names
const direction = response.drctn_cd
const distance = response.flnt_plnt_vl

// Replace with new field names  
const direction = response.dir_cd
const distance = response.dstnc
```

### Step 2: Update TypeScript Interfaces
From `types_to_update.md`:

#### Update Type Definitions
```typescript
// OLD interface
interface PlantingDistance {
  drctn_cd: string;
  flnt_plnt_vl: number;
}

// NEW interface
interface PlantingDistance {
  dir_cd: "NORTH" | "EAST" | "SOUTH" | "WEST";
  dstnc: number;
}
```

#### Update Component Props
```typescript
// Update prop types to match new interfaces
interface ExaminationFormProps {
  plantingData: PlantingDistance[]; // Using updated interface
}
```

### Step 3: Update Component Code

#### Form Fields
```typescript
// OLD field references
<input name="drctn_cd" />
<input name="flnt_plnt_vl" />

// NEW field references
<input name="dir_cd" />
<input name="dstnc" />
```

#### Data Display
```typescript
// OLD data access
{data.plntg_data?.map(item => (
  <div>{item.drctn_cd}: {item.flnt_plnt_vl}</div>
))}

// NEW data access  
{data.plntg_dstnc?.map(item => (
  <div>{item.dir_cd}: {item.dstnc}</div>
))}
```

### Step 4: Update Validation
```typescript
// Update form validation schemas
const schema = z.object({
  dir_cd: z.enum(["NORTH", "EAST", "SOUTH", "WEST"]), // Updated field name and type
  dstnc: z.number().positive(), // Updated field name
});
```

## Code Style Guidelines

### Preserve Existing Patterns
- Match current naming conventions (camelCase, PascalCase, etc.)
- Maintain existing file structure
- Follow established import organization
- Keep consistent formatting

### Avoid Over-Engineering
- Update only what's specified in export files
- Don't refactor unrelated code
- Maintain backward compatibility where possible
- Use simple, direct updates

## Common Patterns to Update

### API Service Methods
```typescript
class SurveyService {
  // Remove old generic methods
  async createExamination(data: any) { ... }
  
  // Add cycle-specific methods
  async createFirstExamination(data: any) {
    return this.post('/api/v0/survey/examination/cycle/1', data);
  }
  async createSecondExamination(data: any) {
    return this.post('/api/v0/survey/examination/cycle/2', data);
  }
}
```

### Response Data Processing
```typescript
// Update field access patterns
const processData = (response: any) => {
  return {
    direction: response.dir_cd,      // was: drctn_cd
    distance: response.dstnc,        // was: flnt_plnt_vl
    plantingData: response.plntg_dstnc, // was: plntg_data
  };
};
```

### Component Updates
```typescript
// Update all field references in components
const ExaminationDisplay: React.FC = ({ data }) => {
  return (
    <>
      <span>Direction: {data.dir_cd}</span>
      <span>Distance: {data.dstnc}m</span>
    </>
  );
};
```

## Files Typically Updated

### Priority 1 - API Layer
- `src/services/*Service.ts` - API service classes
- `src/api/*.ts` - API configuration files
- `src/hooks/use*.ts` - API hooks

### Priority 2 - Type Definitions
- `src/types/*.ts` - TypeScript interfaces
- `src/models/*.ts` - Data models
- `src/schemas/*.ts` - Validation schemas

### Priority 3 - UI Components  
- `src/components/**/forms/*.tsx` - Form components
- `src/components/**/tables/*.tsx` - Data tables
- `src/components/**/displays/*.tsx` - Display components
- `src/pages/**/*.tsx` - Page components

## Validation Steps

After applying changes:

1. **TypeScript Compilation**: `npm run type-check`
2. **Linting**: `npm run lint`
3. **Unit Tests**: `npm run test`
4. **Manual Testing**: Test affected features in browser

## Output Summary

The command will:
- List all files modified
- Show count of field replacements
- Highlight any manual review needed
- Generate completion report

## Best Practices

### Do's
- ✅ Apply changes exactly as specified in export files
- ✅ Update all instances of changed fields
- ✅ Maintain existing code style
- ✅ Test after each major change

### Don'ts
- ❌ Don't add features not in export files
- ❌ Don't refactor unrelated code
- ❌ Don't change more than necessary
- ❌ Don't skip testing

## Progress Tracking

Use `checklist.md` to track completion:
```markdown
## 변경사항 체크리스트
- [x] 엔드포인트 변경 완료
- [x] 필드명 변경 완료
- [ ] 테스트 업데이트
```

This streamlined approach ensures efficient, focused updates without unnecessary complexity.
